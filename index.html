<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XssKillah</title>
</head>
<body>
    <h1>XssKillah</h1>

    <!-- Test template which will be used as a string -->
    <template>
        <div class="some-class" id="abc" style="color:red;" onload="alert(1)">
            <h1>TEST</h1>
            <script>
                alert(2)
            </script>

            <input type="textjavascript" value="YO TEST 123" >

            <form action="balbla.php">
                <input type="text" value="THIS IS A FORM">
            </form>
            <!-- This is a comment -->
            <p>
                This is text alert(5)
            </p>
            <!-- 
            This is another comment
            With mutli lines 
            123 -->
            <script>
                Script text
            </script>
            <section  `how are you`>
                This is some text 
            </section>
            <img src="/" onerror="javascript:alert(1)"></div>
        </div>
    </template>
    <!-- End of test template -->


    <script type="module">
        import xsskillah from './src/xsskillah.js'

        const inputHTML = document.querySelector('template')

        const xss = xsskillah()

        const output1 = xss(inputHTML.innerHTML, {
            outputType: 'html',
            allowTags: ['script'],
            allowTagRules: ['strayBackTicks']
        })

        const output2 = xss(inputHTML.innerHTML, {
            outputType: 'html',
            allowTags: ['script'],
            allowTagRules: ['strayBackTicks']
        })

        const output3 = xss(inputHTML.innerHTML, {
            outputType: 'html',
            allowTags: ['script'],
            allowTagRules: ['strayBackTicks']
        })

        const output4 = xss(inputHTML.innerHTML, {
            outputType: 'html',
            allowTags: ['script'],
            allowTagRules: ['strayBackTicks']
        })

        const output5 = xss(inputHTML.innerHTML, {
            outputType: 'html',
            allowTags: ['script'],
            allowTagRules: ['strayBackTicks']
        })
        document.body.append('beforeend', ...output1)
        document.body.append('beforeend', ...output2)
        document.body.append('beforeend', ...output3)
        document.body.append('beforeend', ...output4)
        document.body.append('beforeend', ...output5)
    </script>
</body>
</html>