{"version":3,"names":["sandboxes","Set","globalDefaults","allowTags","allowTagRules","xssDocReset","xssDoc","document","implementation","createHTMLDocument","SAFE_URL_PATTERN","sanitizeUrl","url","String","match","vulnerableAttributes","vulnerableTags","xssKillah","globalOptions","inputMarkup","instanceOptions","Object","hasOwn","size","sandboxRef","deref","remove","clear","treeWalker","createTreeWalker","body","NodeFilter","SHOW_ELEMENT","allowTagRulesObj","ignoreNodes","node","sandbox","createElement","appendChild","innerHTML","WeakRef","add","value","filter","tag","includes","forEach","querySelectorAll","t","nextNode","indexOfNodeToIgnore","indexOf","splice","name","nodeType","attr","attributes","key","inputTypeJS","formAction","formChildren","push","startsWith","onEvents","removeAttribute","strayDouble","strayDoubleQuotes","straySingle","straySingleQuote","strayBackTick","strayBackTicks","childNodes","makeAlive","selector","parentSelector","scripts","inactiveScript","length","tagName","console","warn","newScript","textContent","replaceWith"],"sources":["0"],"mappings":"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"}